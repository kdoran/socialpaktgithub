{% extends "base.html" %}

{% load producttags %}

{% block fbmetadata %}
  <meta property="og:title" content="{{ product.title }}"/> 
  <meta property="og:url" content="http://{{ request.get_host }}/shirt/{{ product.slug }}/"/> 
  <meta property="og:image" content="http://{{ request.get_host }}{{ product.productphoto_set.all.0.photo.url }}"/> 
  <meta property="og:site_name" content="SocialPakt - Make a Pakt, Make a Difference"/> 
  <meta property="og:type" content="product" /> 
  <meta property="fb:app_id" content="{{ settings.FACEBOOK_APP_ID }}"> 
  <meta property="og:description" content="{{ product.description }}"/> 
{% endblock fbmetadata %}

{% block sharethis %}
  <span  class='st_facebook_vcount' displayText='Facebook'
    st_title = "{{ product.title }}"
    st_url = "http://{{ request.get_host }}/shirt/{{ product.slug }}/"
    st_image = "http://{{ request.get_host }}{{ product.productphoto_set.all.0.photo.url }}"
    st_summary = "{{ product.description }}"
  ></span>
  <span  class='st_twitter_vcount' displayText='Tweet'
    st_title = "{{ product.title }}"
    st_url = "http://{{ request.get_host }}/shirt/{{ product.slug }}/"
    st_image = "http://{{ request.get_host }}{{ product.productphoto_set.all.0.photo.url }}"
    st_summary = "{{ product.description }}"
  ></span>
  <span  class='st_email_vcount' displayText='Email'
    st_title = "{{ product.title }}"
    st_url = "http://{{ request.get_host }}/shirt/{{ product.slug }}/"
    st_image = "http://{{ request.get_host }}{{ product.productphoto_set.all.0.photo.url }}"
    st_summary = "{{ product.description }}"
  ></span>
  <span  class='st_plusone_vcount' 
  st_title = "{{ product.title }}"
    st_url = "http://{{ request.get_host }}/shirt/{{ product.slug }}/"
    st_image = "http://{{ request.get_host }}{{ product.productphoto_set.all.0.photo.url }}"
    st_summary = "{{ product.description }}"
  ></span>
{% endblock sharethis %}

{% block localscripts %}
      <script src="{{ STATIC_URL }}js/lib/countdown.js"></script>
      <script src="{{ STATIC_URL }}js/catalog.js"></script>
{% endblock localscripts %}

{% block main %}
    <div id="productblock">
        <div id="shirtblock">
          <h3 class="explanation"><span class="label">Each tee you buy</span>{{product.call_to_action}}</h3>
          <div id="shirt">
              {% for photo in product.productphoto_set.all %}
              <div class="shirtimage {% if forloop.first %}big{% else %}thumbnail{% endif %}">
                  <img width="580px" src="{{photo.photo.url}}" alt="{{photo.description}}">
                  {% if photo.photo_large %}
                    <a class="photodetail" href="{{photo.photo_large.url}}" alt="Detail">Large</a>
                  {% endif %}
              </div>
              {% endfor %}
          </div>
          <a id="photodetaillink" href="#">Show Large</a>
        </div>

        <div id="purchase">

          {% if product.date_expires >= now %}
            <div id="timeleft">
                <h3>time left to buy:</h3>
                <div id='expiresdate'>{{product.date_expires|date:"Y-m-d H:i:s"}}</div>
            </div>
          {% endif %}

        <div class="charity">
            
            <h3>Featured Nonprofit</h3>
              <a href="{% url nonprofit product.benefits.slug %}" class="charity_logo"><img width="250px" style="width:250px" src="{% if product.benefits.image %}{{product.benefits.image.url}}{% endif %}" alt="{{product.benefits.name}}"></a>
          </div>


          <div id="donations">
              <div class="donation">
                  <h3>donated</h3>
                  <div class="number"><span class="dollarsign">$</span>{{product.total_raised|floatformat}}</div>
              </div>
              <div class="goal">
                  <h3>our goal</h3>
                  <div class="number"><span class="dollarsign">$</span>{{product.goal|floatformat}}</div>
              </div>
          </div>




          {% if can_add_to_cart %}
          

          <form action="https://socialpakt.foxycart.com/cart" method="post">
              <input type="hidden" name="name" value="{{product.cart_title}}" />
              <input type="hidden" name="code" value="{{product.slug}}" />
              <input type="hidden" name="price" value="{{product.price}}" />
              <input type="hidden" name="quantity" value="1">
              <select id="shirt_select" name="shirt">
                  {% for v in product.productvariation_set.all %}
                    {% if v.inventory > 0 or not product.has_inventory %}
                      <option value="{{v.description}}">{{v.description}}</option>
                    {% endif %}
                  {% endfor %}
              </select>
          
              <div id="sizes">
                  <div class="womens">
                      <h3><span class="price">${{product.price|floatformat}}</span> Women's Tee</h3>
                      <a class="sizeandfit" href="/sizingchart/">size and fit</a>
                      <ul class="options">
                          <li id="Women's S" class="size stock{% product_stock product.productvariation_set "Women's S" %}">s</li>
                          <li id="Women's M" class="size stock{% product_stock product.productvariation_set "Women's M" %}">m</li>
                          <li id="Women's L" class="size stock{% product_stock product.productvariation_set "Women's L" %}">l</li>
                          <li id="Women's XL" class="size stock{% product_stock product.productvariation_set "Women's XL" %}">xl</li>
                      </ul>
                  </div>
                  <div class="mens">
                      <h3><span class="price">${{product.price|floatformat}}</span> Men's Tee</h3>
                      <a class="sizeandfit" href="/sizingchart/">size and fit</a>
                      <ul class="options">
                          <li id="Men's S" class="size stock{% product_stock product.productvariation_set "Men's S" %}">s</li>
                          <li id="Men's M" class="size stock{% product_stock product.productvariation_set "Men's M" %}">m</li>
                          <li id="Men's L" class="size stock{% product_stock product.productvariation_set "Men's L" %}">l</li>
                          <li id="Men's XL" class="size stock{% product_stock product.productvariation_set "Men's XL" %}">xl</li>
                      </ul>
                  </div>
              </div>

          
              <div id="addtocart">
                  <input class="disabled" disabled="true" type="submit" name="add to cart" value="Add to Cart" id="cartbutton">
              </div>

          </form>

          <!--<form action="https://socialpakt.foxycart.com/cart" method="post">
              <input type="text" name="coupon" value="{{product.cart_title}}" />         
              <div id="addtocart">
                  <input type="submit" name="addcoupon" value="Add Coupon">
              </div>

          </form>-->


          
          {% endif %}
        </div>
    </div>
{% endblock main %}

{% block fbcomments %}
<div id="comments">
  <h3>What People Are Saying</h3>
    <fb:comments href="http://{{ request.get_host }}/shirt/{{product.slug}}/" num_posts="5" width="600"></fb:comments>
</div>
{% endblock fbcomments %}

{% block about %}
  <div class="aboutcharity">
      <span class="label">about the charity</span>
      <h3><a href="{% url nonprofit product.benefits.slug %}">{{product.benefits.name}}</a></h3>
      <p>{{product.benefits.about|safe|truncatewords_html:30|striptags}} <a href="{% url nonprofit product.benefits.slug %}">more</a></p>
  </div>
  <div class="aboutartist">
      <span class="label">about the artist</span>
      <h3><a href="{% url artist product.artist.slug %}">{{product.artist.name}}</a></h3>
      <p>{{product.artist.about|safe|truncatewords_html:30|striptags}} <a href="{% url artist product.artist.slug %}">more</a></p>
  </div>
{% endblock about %}